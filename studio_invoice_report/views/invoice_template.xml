<odoo>
    <data>
        <record id="report_invoice_document_kof_inherited" model="ir.ui.view">
            <field name="name">account.invoice.report.kof.inherited</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.report_invoice_document"/>
            <field name="arch" type="xml">

                <!-- 1. Remplacer l'en-tête -->
                <xpath expr="//t[@t-call='web.external_layout']/div[has-class('header')]" position="replace">
                    <div class="header">
                        <div class="header-section row">
                            <div class="col-7">
                                <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-width: 150px; max-height: 80px;" alt="Logo"/><br/>
                                <div style="font-size: 11px; line-height: 1.5;">
                                    <strong><span t-field="o.company_id.name"/> SAS</strong><br/>
                                    <span><i class="fa fa-map-marker"/> Fenêtre Mermoz</span><br/>
                                    <span>DAKAR SN 990000</span><br/>
                                    <span>Sénégal</span><br/>
                                    <span><i class="fa fa-phone"/> <span t-field="o.company_id.phone"/></span><br/>
                                    <span><i class="fa fa-envelope"/> <span t-field="o.company_id.email"/></span>
                                    <hr style="border-top: 1px solid black; margin-top: 5px; margin-bottom: 5px;"/>
                                </div>
                            </div>
                            <div class="col-5" style="text-align: right; font-style: italic; font-size: 13px;">
                                Bien plus qu'un Cabinet d'Expertise-Comptable, un Partenaire d'Avenir !
                            </div>
                        </div>
                    </div>
                </xpath>

                <!-- 2. Remplacer le pied de page -->
                <xpath expr="//t[@t-call='web.external_layout']/div[has-class('footer')]" position="replace">
                    <div class="footer">
                        <div style="font-size: 9px; border-top: 1px solid #ccc; padding-top: 5px; text-align: center;">
                            <p>
                                Contacts: - Ngaparou: 33 957 71 99 | Fax: 33 957 72 00 - Dakar: 33 824 31 31 - Saint Louis: 33 961 76 43 - Thiès: 33 951 97 51 - Ziguinchor: 33 991 07 17
                                <br/>
                                Courriel: contact@kof-experts.sn | Site Web: http://www.kof-experts.sn | Numéro fiscal: NINEA: 005652583 2X2 | Reg: SN THS 2015 m 3362
                                <br/>
                                Références bancaires: Ngaparou/Dakar/Thiès/Ziguinchor/Saint Louis: -BOA: SN100 09003 006274910007 20 / SWIFT AFRISNDAXXX - BICIS: SN010 01520 021397300065 32
                            </p>
                            <div class="text-center">
                                Page: <span class="page"/> / <span class="topage"/>
                            </div>
                        </div>
                    </div>
                </xpath>

                <!-- 3. Remplacer le contenu de la page -->
                <xpath expr="//div[has-class('page')]" position="replace">
                    <div class="page">
                        <!-- Styles CSS spécifiques au corps de la facture -->
                        <style type="text/css">
                            .page {
                                font-family: 'Helvetica', sans-serif;
                                font-size: 12px;
                                color: #333;
                            }
                            .address-section {
                                margin-top: 30px;
                            }
                            .partner-address {
                                text-align: right;
                            }
                            .invoice-title-section {
                                margin-top: 20px;
                            }
                            .invoice-title {
                                font-size: 28px;
                                font-weight: bold;
                                color: #FF6B00;
                            }
                            .net-to-pay {
                                text-align: right;
                                border: 1px solid #ddd;
                                padding: 10px;
                                background-color: #f9f9f9;
                            }
                            .net-to-pay h3 {
                                margin: 0;
                                font-size: 14px;
                            }
                            .net-to-pay .amount {
                                font-size: 24px;
                                font-weight: bold;
                                color: #FF6B00;
                            }
                            .info-table {
                                margin-top: 10px;
                                width: 100%;
                            }
                            .info-table td {
                                padding: 5px;
                                border: 1px solid #ddd;
                            }
                            .info-table td:first-child {
                                background-color: #f2f2f2;
                                font-weight: bold;
                                width: 35%;
                            }
                            .lines-table {
                                width: 100%;
                                margin-top: 30px;
                                border-collapse: collapse;
                            }
                            .lines-table th {
                                background-color: #FF6B00;
                                color: white;
                                padding: 8px;
                                text-align: left;
                            }
                            .lines-table td {
                                padding: 8px;
                                border-bottom: 1px solid #ddd;
                            }
                            .totals-section {
                                margin-top: 20px;
                            }
                            .text-right { text-align: right; }
                            .text-center { text-align: center; }
                        </style>

                        <!-- Adresse du partenaire -->
                        <div class="address-section row">
                            <div class="col-6 offset-6 partner-address">
                                <strong>À: <span t-field="o.partner_id.name"/></strong><br/>
                                <span t-field="o.partner_id" t-options='{"widget": "contact", "fields": ["address"], "no_marker": True}'/>
                            </div>
                        </div>

                        <!-- Titre de la facture et Net à payer -->
                        <div class="invoice-title-section row">
                            <div class="col-7">
                                <span class="invoice-title" t-field="o.name"/>
                            </div>
                            <div class="col-5 net-to-pay">
                                <h3>Net à payer</h3>
                                <div class="amount">
                                    <span t-field="o.amount_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </div>
                                <small>Paiement: <span t-field="o.payment_reference"/></small>
                            </div>
                        </div>

                        <!-- Tableau d'informations -->
                        <div class="row">
                            <div class="col-7">
                                <table class="info-table">
                                    <tr>
                                        <td>Date</td>
                                        <td><span t-field="o.invoice_date" t-options='{"format": "dd/MM/yyyy"}'/></td>
                                    </tr>
                                    <tr>
                                        <td>Référence/Description</td>
                                        <td><span t-esc="o.narration or 'N/A'"/></td>
                                    </tr>
                                    <tr t-if="o.partner_id.ref">
                                        <td>N° du client</td>
                                        <td><span t-field="o.partner_id.ref"/></td>
                                    </tr>
                                    <tr>
                                        <td>Date d'échéance</td>
                                        <td><span t-field="o.invoice_date_due" t-options='{"format": "dd/MM/yyyy"}'/></td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <!-- Lignes de facture -->
                        <table class="lines-table">
                            <thead>
                                <tr>
                                    <th>Prestation</th>
                                    <th class="text-center">Qte</th>
                                    <th class="text-right">Prix unitaire</th>
                                    <th class="text-right">Taxe</th>
                                    <th class="text-right">Montant</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="o.invoice_line_ids" t-as="line">
                                    <tr t-if="line.display_type == 'product'">
                                        <td><span t-field="line.name"/></td>
                                        <td class="text-center"><span t-field="line.quantity"/></td>
                                        <td class="text-right"><span t-field="line.price_unit" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></td>
                                        <td class="text-right"><span t-esc="', '.join(map(lambda x: x.name, line.tax_ids))"/></td>
                                        <td class="text-right"><span t-field="line.price_subtotal" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>

                        <!-- Totaux -->
                        <div class="totals-section row">
                            <div class="col-6 offset-6">
                                <t t-call="account.document_tax_totals">
                                    <t t-set="tax_totals" t-value="o.tax_totals"/>
                                    <t t-set="currency" t-value="o.currency_id"/>
                                </t>
                            </div>
                        </div>
                    </div>
                </xpath>

            </field>
        </record>
    </data>
</odoo>
